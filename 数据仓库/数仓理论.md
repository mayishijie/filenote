# 1. 常说的数据平台包含三部分

## 1. 数据相关产品，技术，工具

> 1. 批量采集传输：sqoop，flume
> 2. 离线数据处理：hive，spark
> 3. 实时流处理：spark streaming，flink, storm(过时，几乎不用)



## 2. 数据资产

> 说白了就是公司里面的数据

## 3. 数据管理

> 有工具，有数据，那么就需要用工具来处理这些数据，让这些数据产生价值，所以也就有一些数据管理方面的技术
>
> - 数据仓库、
> - 数据建模、
> - 数据质量、
> - 数据规范、
> - 数据安全和元数据管理

# 2. 数据分层

## 1. ODS：原始数据层，不错数据处理，作为备份，一般压缩，lzo 10：1

## 2. DWD：数据明细层，

## 3. DWS：汇合层，轻度数据汇合

## 3.1 DWT：面向主题做更细一层的划分（大部分只有4层）

## 4. ADS：数据应用层

# 3. 数仓技术：OLTP和OLAP

## 1. OLTP：对应传统数据库（给业务上的客户）

> 增删改查，传统关系型数据库，分库分表，索引技术

## 2. OLAP：分析性数据库（内部人常用）

> 列存储，列压缩，位图索引

# 4. 三种搭建数仓方式

## 1. 在传统的OLTP数据库中搭建

## 2. 商业数据库产品搭建（MPP架构）

## 3. 基于Hadoop（常用）

# 5. 2大建模派系Bil inmon,ralph kimball()

一般采用kimball的维度建模理论，开发块，后期维护相对复杂（一般企业都是用这种）

Bil inmon: 使用方便，但是开发周期长，（稳定性的大项目会用）

# 6. 维度建模

## 1. 星型模型

> 一般只有一维，一个事实多个维度，（实际业务中比较多）

## 2. 星座模型

> 有多个事实表，可以理解为星型组成了星座

## 3. 雪花模型

> 比较接近3NF,但是对于性能来说，成本太高



> 实际上应该是星座的，冗余很多字段，比较对于查询性能来说更好，所以对于Hadoop平台，星型模型是比较多的选择，雪花模型在传统数据库中，比较多

# 7. 仓库体系架构

## 1. 维度数据仓库

>原子的，采用维度建模，建成的数据仓库

## 2. 数据集市

> 维度数据仓库各种集成的主题域

# 8. 数据管理

## 1. 数据探查

> 对数据本身以及关联关系进行分析
>
> - 数据是否存在
> - 都有那些字段
> - 数据是否规范明确
> - 字段的分析和质量
>
> 主要技术
>
> - 主外键
> - 字段类型
> - 字段长度
> - 空值占比
> - 枚举值分布
> - 极限值：最大，最小，平均值等

## 2. 数据集成：也可以叫ETL

### 1. ETL工具：kettle，Talend，hive，spark

### 2. ELT

> 泛指从数据源抽取，经过转换，清洗等，最终按预先设计的数据模型，将数据加载到数据仓库的过程。

### 3. ETL结果，是为使用者提供一个汇总，规范，包含所有相关信息的宽边，select * 可以拿到所有数据



## 3. 数据质量

### 1. 完整性

> 数据是否存在缺失情况

### 2. 一致性

> 数据是否遵循统一规范，统一格式
>
> - 数据记录规范：比如说IP地址是4个0-255的数据加点组成
> - 数据是否符合逻辑，年龄不可能为负数

### 3. 准确性

> 与一致性的区别，准确性不仅是规则上的一致性，更多是业务规则上的冲突，比如某个字段只有0和1，出现2或者其它，那就是有问题的

### 4. 及时性

> 数据产生的时间，是否准时，准确，符合预期

## 4. 元数据管理

> 

## 5. 数据屏蔽

> 对数据进行脱敏，敏感信息，手机号，身份证，银行卡等
>
> 主要方法
>
> - 替换
> - 洗牌
> - 删除/加扰
> - 加密

# 9. 建模四部曲

## 1. 选取业务过程

## 2. 确认粒度

## 3. 确定维度

## 4. 确定事实

# 10.维度表和事实表

## 1. 维度表

> 一般是对事实的描述信息，比如用户，地区，商品等
>
> 可以理解为其实维度就是一个事实表中某个字段中更加详细的的描述，比如说事实表可能只有一个字段用户I的，那么我们的维度表，用户信息表，则可能包含很多信息，性别，籍贯等，所以列会比较多，但是行数比较少，而且一般变动不大。
>
> 维表特征
>
> - 维表范围很宽（列比较多）
> - 和事实表相比，行数少
> - 内容相对固定，编码表

## 2. 事实表

> 事实表中，每一行都可以代表一个事件，比如下单，支付，退款，评价等
>
> 事实这个术语，可以表示业务事件中的度量值（可以统计金额，次数，个数等）
>
> 特征
>
> - 非常大
> - 内容相对窄：列少点
> - 经常发生变化

### 1. 事务性事实表

> 以每个事件/事务为单位，比如一个销售订单记录，一笔支付记录等，**数据一旦插入，则不再变更**
>
> 其更新方式是增量更新

### 2. 周期性快照表（比如购物车，收藏等）

> **不会保留所有数据**，**只保留固定时间间隔的数据**，例如每天或者每月的销售额，或每月的账户余额等。

### 3. 累积型快照表（一条数据会在不同时间发生变化，每个字段记录变化过程）

> **累计快照事实表用于跟踪业务事实的变化** ,比如：数据仓库中可能需要累积或者存储订单从下订单开始，到订单商品被打包、运输、和签收的各个业务阶段的时间点数据来跟踪订单声明周期的进展情况

# 11.数仓建模绝对重点

## 1. ODS

> 1. 数据保持原貌，不做修改，做备份
> 2. 数据采用压缩，节省空间，可以做到10:1
> 3. 创建分区表，防止后续全表扫描

## 2. DWD

DWD需要构建维度模型，一般采用星型模型，呈现的状态是星座模型

开始4部曲

1. 选择业务过程

   > 选择我们感兴趣的业务，比如下单业务，支付业务，退款业务，物流业务，一条业务线对应一个事实表

2. 声明粒度

   > **声明粒度就是表明事实表中一行数据表示什么**
   >
   > 比如下面一些
   >
   > - 订单中，每个商品项作为下单事实表中的一行
   > - 每周的订单次数作为一行，粒度就是每周下单。
   > - 每月的订单次数作为一行，粒度就是每月下单

3. 确认维度

   > 主要是描述业务是事实，主要表示的是谁，何处，何时，就是事实表某个指标的详细描述信息

4. 确认事实

> 是指业务中的度量值，订单金额，下单次数等
>
> 在DWD层，以**业务过程**为建模驱动，基于每个具体业务过程的特点，构建**最细粒度**的明细层事实表。事实表可做适当的宽表化处理。

## 3. DWS

> 统计各个主题对象的当天行为，服务于DWT层的主题宽表。
>
> 说白了，其实就是针对某个主题做统计指标
>
> 如下
>
> - 每日设备行为
> - 每日会员行为
> - 每日商品行为
> - 每日地区统计
> - 每日活动统计

## 4. DWT

> 以分析的**主题对象**为建模驱动，基于上层的应用和产品的指标需求，构建主题对象的全量宽表。
>
> 很多时候，基本上就是4层，把DWT和DWS放一起，就是直接按照主题进行统计

## 5. ADS

> 对各大主题指标分别进行分析

# 12. 业务数据同步策略

## 1. 全量

> 量比较少，且变化比较少
>
> 比如商品信息表

## 2. 特殊

> 几乎不会变的，比如省市地区等

## 3. 新增以及变化

> 几乎每天都会有新增，也有修改，量比较大
>
> 比如用户表

## 4. 增量

> 每天都会新增，且量很大，比如支付流水表

# 13. 常用表小结针对业务数据

## 1. 拉链表-针对维度表

> 记录每条信息的生命周期，
>
> 比较适合那些大部分数据不会发生变化，只有一小部分数据发生变化的数据（缓慢变化维度）

## 2. 事实表

### 	1. 事务性事实表（支付流式，订单）

### 	2. 周期性事实表（加购物车表，收藏表）

### 	3. 累积型事实表（物流信息，优惠券领用表）